<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Gemini Chatbot Application</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body, html {
          height: 100%;
          margin: 0;
          font-family: Arial, sans-serif;
          background-color: #f8f9fa;
          display: flex;
          justify-content: center;
          align-items: center;
      }

      .chat {
          width: 400px;
          height: 600px;
          display: flex;
          flex-direction: column;
          border: 1px solid #ccc;
          border-radius: 12px;
          background-color: #fff;
          box-shadow: 0px 4px 15px rgba(0,0,0,0.1);
          overflow: hidden;
      }

      .chat-header {
          background: linear-gradient(135deg, #007bff, #00c6ff);
          color: white;
          padding: 15px;
          font-size: 20px;
          font-weight: bold;
          text-align: center;
      }

      .chat-body {
          flex: 1;
          padding: 10px;
          overflow-y: auto;
          background-color: #f4f6f9;
      }

      .chat-footer {
          display: flex;
          gap: 5px;
          padding: 10px;
          background-color: #e9ecef;
      }

      #message-input {
          flex: 1;
          border-radius: 20px;
          border: 1px solid #ccc;
          padding: 10px;
      }

      #send-button {
          border-radius: 20px;
          padding: 8px 20px;
          font-weight: bold;
      }

      .chat-message {
          max-width: 75%;
          padding: 10px;
          margin: 5px 0;
          border-radius: 15px;
          clear: both;
          word-wrap: break-word;
          font-size: 14px;
          line-height: 1.4;
      }

      .chat-message.user {
          background-color: #007bff;
          color: white;
          align-self: flex-end;
          border-bottom-right-radius: 0;
      }

      .chat-message.bot {
          background-color: #e1e9f5;
          color: #333;
          align-self: flex-start;
          border-bottom-left-radius: 0;
      }

      .chat-body::-webkit-scrollbar {
          width: 6px;
      }

      .chat-body::-webkit-scrollbar-thumb {
          background-color: rgba(0,0,0,0.2);
          border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <div class="chat">
        <div class="chat-header">CHATBOT</div>
        
        <div class="chat-body" id="chat-body"></div>

        <div class="chat-footer">
            <input type="text" class="form-control" id="message-input" placeholder="Type your message here...">
            <button class="btn btn-primary" id="send-button">Send</button>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.min.js"></script>

    <script>
      $(document).ready(function () {
          $('#send-button').click(function(){
              sendMessage();
          });

          $('#message-input').keypress(function(e) {
              if (e.which === 13) { // Enter key
                  sendMessage();
              }
          });

          function sendMessage() {
              var userMessage = $('#message-input').val().trim();

              if (userMessage) {
                  $('#chat-body').append('<div class="chat-message user">' + userMessage + '</div>');
                  $('#message-input').val("");
                  $('#chat-body').scrollTop($('#chat-body')[0].scrollHeight);

                  $.ajax({
                      url: '/chat',
                      type: 'POST',
                      contentType: 'application/json',
                      data: JSON.stringify({ "message": userMessage }),
                      success: function (response) {
                          $('#chat-body').append('<div class="chat-message bot">' + response.response + '</div>');
                          $('#chat-body').scrollTop($('#chat-body')[0].scrollHeight);
                      },
                      error: function (xhr, status, error) {
                          console.error("Error: " + error);
                      }
                  });
              }
          }
      });
    </script>
  </body>
</html>
